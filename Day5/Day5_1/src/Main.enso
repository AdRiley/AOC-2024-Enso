from Standard.Base import all
from Standard.Table import all
from Standard.Database import all
from Standard.AWS import all
from Standard.Google_Api import all
from Standard.Snowflake import all
import Standard.Examples
import Standard.Visualization

## ICON group
get_middle_page any8 =
    any9 = any8.split ','
    integer1 = ((any9.length - 1) / 2)
    any11 = integer1.truncate
    any10 = any9.at any11
    any1 = any10.parse_integer
    any1

main =
    file1 = Data.read '/Users/adriley/Code/AOC-2024-Enso/Day5/input.txt'
    ## page ordering rules
    any1 = file1.parse_to_table (regex "(\d.)\|(\d.)\n")
    any2 = file1.parse_to_table (regex "(?:\d+[,])+\d+")
    table1 = any2.add_row_number "UpdateId"
    table2 = table1.split_to_rows 'Column'
    table3 = table2.add_row_number "Position"
    ## pages to produce in each update
    table5 = table3.parse
    table4 = any1.join table5 ..Inner [(..Equals 'Column 1' 'Column')]
    any3 = table4.rename_columns [(Pair.Value 'Position' 'Before')]
    table6 = any3.join table5 ..Inner [(..Equals 'UpdateId'), (..Equals 'Column 2' 'Column')]
    any4 = table6.rename_columns [(Pair.Value 'Position' 'After')]
    any5 = any4.filter (expr '[Before]>[After]')
    ## list of incorrect UpdateIds
    any6 = any5.aggregate ['UpdateId']
    ## Correct updates
    table7 = table1.join any6 ..Left_Exclusive [(..Equals 'UpdateId')]
    any7 = table7.at 'Column'
    any8 = any7.at 0
    any10 = Main.get_middle_page any8
    any11 = any7.map get_middle_page
    ## Part 1
    any12 = any11.compute ..Sum
    any13 = table6.aggregate ['UpdateId', 'Column 1'] [..Count]
    any14 = any13.sort [(..Name 'UpdateId'), (..Name 'Count' ..Descending)]
    any16 = any14.cast ['Column 1'] ..Char
    ## I don't actually care what the last number is to get the answer so just proxy it with 42
    any15 = any16.aggregate ['UpdateId'] [..Concatenate 'Column 1' separator="," suffix=",42"]
    ## Incorrect Updates
    table8 = any6.join any15 ..Inner [(..Equals 'UpdateId')]
    any17 = table8.at 'Concatenate Column 1'
    any21 = any17.map get_middle_page
    ## Part 2
    any20 = any21.compute ..Sum



#### METADATA ####
[[{"index":{"value":281},"size":{"value":4}},"2a634298-b55d-4352-af97-db5602d35135"],[{"index":{"value":299},"size":{"value":10}},"0c6541ea-3607-4338-918f-59fe880890ae"],[{"index":{"value":299},"size":{"value":14}},"8d534ec5-b838-4c00-9f10-223c71d0f5af"],[{"index":{"value":329},"size":{"value":23}},"1c4e07be-9b81-412b-9ed8-e4e11a4fb013"],[{"index":{"value":330},"size":{"value":21}},"394cdbb0-3eca-43d4-9e5b-1bef56bcf533"],[{"index":{"value":365},"size":{"value":17}},"22af406d-0cb0-48f6-89fc-010186b17933"],[{"index":{"value":395},"size":{"value":7}},"11dfb1d2-d13f-4899-b496-57704b1e35c1"],[{"index":{"value":395},"size":{"value":13}},"7f0f6dab-e4e5-466a-90c6-fc6e63a6dbd5"],[{"index":{"value":420},"size":{"value":19}},"b7d508c6-a88b-4d4b-965d-6a4392a1801c"],[{"index":{"value":444},"size":{"value":4}},"c51e41e6-e183-4def-b2fa-a799d61bdb3e"],[{"index":{"value":469},"size":{"value":60}},"fcf199e6-d2b1-44b7-be92-a47545d6a593"],[{"index":{"value":568},"size":{"value":20}},"7a513863-f738-4f45-94a9-d2266b17e133"],[{"index":{"value":568},"size":{"value":45}},"9a250556-286a-48ba-bb38-3e01f8d03162"],[{"index":{"value":625},"size":{"value":20}},"a5cdcb73-0a7d-452d-afcf-87909b717fa4"],[{"index":{"value":625},"size":{"value":45}},"899eab94-98e9-461b-ba5f-d311c1edd65c"],[{"index":{"value":684},"size":{"value":19}},"590e6f8c-a2a1-40b3-86c9-51c859eb0cc2"],[{"index":{"value":684},"size":{"value":30}},"c5d27b49-8285-41a6-adb3-c033a38223f8"],[{"index":{"value":728},"size":{"value":20}},"44bad59f-1a84-40df-830a-17e4e401ccb6"],[{"index":{"value":728},"size":{"value":29}},"ccfcd6e3-ffb0-47f6-b3f8-1cf38297881e"],[{"index":{"value":771},"size":{"value":21}},"4ce11549-60dd-46e7-8d62-3c2800f12719"],[{"index":{"value":771},"size":{"value":32}},"bcb77af3-fa21-49fd-8173-34c2b729218f"],[{"index":{"value":856},"size":{"value":12}},"69e4cb83-90b9-4db2-ab7e-c914f49c7722"],[{"index":{"value":882},"size":{"value":9}},"74c6dc74-6764-41d1-a541-98767571a140"],[{"index":{"value":882},"size":{"value":16}},"603da34e-2c94-4e04-9676-be68f03381c5"],[{"index":{"value":882},"size":{"value":24}},"95e5e435-ed62-4fa4-9e6c-610ebf796e46"],[{"index":{"value":882},"size":{"value":57}},"0409e7fc-e7f6-45c3-832b-b8f40bb8a8e0"],[{"index":{"value":951},"size":{"value":21}},"11af906e-a55d-41c3-939a-0be843a5b94b"],[{"index":{"value":951},"size":{"value":56}},"425d49e3-847f-4e58-a496-e2b7405364f9"],[{"index":{"value":1021},"size":{"value":9}},"24ddf802-0bd1-430a-b1cc-0ee2239f4d2f"],[{"index":{"value":1021},"size":{"value":16}},"77f58d17-2010-4031-b62a-5b4a115cc99c"],[{"index":{"value":1021},"size":{"value":24}},"24cd607b-3202-4c4a-bd27-563e8df03571"],[{"index":{"value":1021},"size":{"value":80}},"c1a62721-cf7c-490f-af65-20345afc5ffc"],[{"index":{"value":1113},"size":{"value":21}},"7b197091-4db1-40fe-9a67-86e3f3bca6bc"],[{"index":{"value":1113},"size":{"value":55}},"a6239834-c8e2-4d7b-aa2e-c7cfc64be433"],[{"index":{"value":1180},"size":{"value":11}},"32bb291b-e25a-4c89-8760-5c41b841f251"],[{"index":{"value":1180},"size":{"value":37}},"df9c26c7-cf78-46d4-98d2-c05696039acd"],[{"index":{"value":1264},"size":{"value":14}},"18200431-165c-4116-9893-2f5dc79ff54d"],[{"index":{"value":1264},"size":{"value":27}},"e4d79fc2-d38f-4d6c-b5a4-5ef5b916c8e4"],[{"index":{"value":1328},"size":{"value":11}},"83fc9500-236d-4115-8773-3b4c759f89ca"],[{"index":{"value":1328},"size":{"value":16}},"6d2458a8-f38a-463d-8545-f66ae1d6d3bc"],[{"index":{"value":1328},"size":{"value":33}},"3da8c33d-1103-4ebe-af90-ece19487beb6"],[{"index":{"value":1328},"size":{"value":57}},"3e1e7e92-b03c-4f00-a65e-44656bf5bcbf"],[{"index":{"value":1397},"size":{"value":9}},"fcb092bc-992c-435c-bc95-93ef10e93e86"],[{"index":{"value":1397},"size":{"value":18}},"137054d1-242c-4227-a58e-386506a9414e"],[{"index":{"value":1427},"size":{"value":7}},"9a1654d1-fe07-4050-b03c-07cd34eb1f02"],[{"index":{"value":1427},"size":{"value":9}},"f4a2ba8c-ec97-43b2-808b-c503d73bdb6a"],[{"index":{"value":1449},"size":{"value":25}},"cd2cc1f3-4e7c-4095-b680-e24b599bbf8c"],[{"index":{"value":1487},"size":{"value":8}},"1d25c775-6ff4-43fd-b3ee-11599e30533c"],[{"index":{"value":1487},"size":{"value":24}},"c0db1295-5f57-4f19-85fd-17890d93e02c"],[{"index":{"value":1538},"size":{"value":13}},"7f4bd2d1-a844-4a6c-9eab-e1f22f6a224d"],[{"index":{"value":1538},"size":{"value":19}},"b181f8f6-ef42-4986-9191-f72fa0f64f44"],[{"index":{"value":1570},"size":{"value":16}},"eff81253-44f8-4bd5-9340-912013fc8056"],[{"index":{"value":1570},"size":{"value":41}},"87eb12ca-b0df-43ca-8275-11f182fea115"],[{"index":{"value":1570},"size":{"value":51}},"bb3ff5ae-a767-421c-947d-5ed5da39d001"],[{"index":{"value":1634},"size":{"value":10}},"7b96a543-6696-4ecd-bda7-11a83eece4c0"],[{"index":{"value":1634},"size":{"value":63}},"0e725942-cc1f-4d2f-bd3a-cc385d2a2d3f"],[{"index":{"value":1710},"size":{"value":10}},"b792dadc-c329-4a47-9e68-072cd342bace"],[{"index":{"value":1710},"size":{"value":23}},"72ea1696-029a-4659-b460-23a05cd1fb59"],[{"index":{"value":1710},"size":{"value":30}},"fb0957ea-ad38-4322-a201-907be08cda50"],[{"index":{"value":1849},"size":{"value":15}},"6254d52a-3709-4ec8-9093-021dd9ed5003"],[{"index":{"value":1849},"size":{"value":28}},"5fd9c320-8a24-4ad3-8761-0f0430581ae6"],[{"index":{"value":1849},"size":{"value":82}},"d6536700-3a0d-4028-a140-94e9ddbb8a76"],[{"index":{"value":1970},"size":{"value":9}},"6db8b87f-6a73-494c-a592-2a7ee5b04d08"],[{"index":{"value":1970},"size":{"value":15}},"402b2b68-9212-4197-9e77-977a3384b3ef"],[{"index":{"value":1970},"size":{"value":23}},"51cf8779-b972-4778-9be3-c30a69239b3a"],[{"index":{"value":1970},"size":{"value":47}},"7f38bd13-4b20-4c7d-b8d1-8f8a5f3f06c2"],[{"index":{"value":2030},"size":{"value":9}},"511e0fd8-2977-441d-8e7b-563b6b9e29a7"],[{"index":{"value":2030},"size":{"value":32}},"242ec5de-7262-4eb2-89e2-749180e2e92c"],[{"index":{"value":2075},"size":{"value":25}},"160702ad-156f-40d9-ac72-ca8bd014d6ea"],[{"index":{"value":2127},"size":{"value":19}},"37cb3916-2ae9-4466-85db-ef7e67ff951b"]]
{"ide":{"node":{"2a634298-b55d-4352-af97-db5602d35135":{"position":{"vector":[-230,-1780]}},"8d534ec5-b838-4c00-9f10-223c71d0f5af":{"position":{"vector":[-230,-1852]}},"0c6541ea-3607-4338-918f-59fe880890ae":{"position":{"vector":[-230,-1852]}},"1c4e07be-9b81-412b-9ed8-e4e11a4fb013":{"position":{"vector":[-165,-1924]}},"394cdbb0-3eca-43d4-9e5b-1bef56bcf533":{"position":{"vector":[-71,-1924]}},"22af406d-0cb0-48f6-89fc-010186b17933":{"position":{"vector":[-165,-1995]}},"7f0f6dab-e4e5-466a-90c6-fc6e63a6dbd5":{"position":{"vector":[-230,-2067]}},"11dfb1d2-d13f-4899-b496-57704b1e35c1":{"position":{"vector":[-233,-2014]}},"b7d508c6-a88b-4d4b-965d-6a4392a1801c":{"position":{"vector":[-230,-2125]}},"c51e41e6-e183-4def-b2fa-a799d61bdb3e":{"position":{"vector":[-230,-2197]}},"fcf199e6-d2b1-44b7-be92-a47545d6a593":{"position":{"vector":[-388,-341]},"visualization":{"show":false,"width":1027.671875,"height":663.51171875}},"9a250556-286a-48ba-bb38-3e01f8d03162":{"position":{"vector":[-403,-591]},"visualization":{"show":false,"width":448.765625,"height":262.16796875}},"7a513863-f738-4f45-94a9-d2266b17e133":{"position":{"vector":[-420,-188]}},"899eab94-98e9-461b-ba5f-d311c1edd65c":{"position":{"vector":[11,-413]},"visualization":{"show":false,"height":168.578125}},"a5cdcb73-0a7d-452d-afcf-87909b717fa4":{"position":{"vector":[312,-188]}},"c5d27b49-8285-41a6-adb3-c033a38223f8":{"position":{"vector":[11,-466]}},"590e6f8c-a2a1-40b3-86c9-51c859eb0cc2":{"position":{"vector":[5,-260]}},"ccfcd6e3-ffb0-47f6-b3f8-1cf38297881e":{"position":{"vector":[11,-519]}},"44bad59f-1a84-40df-830a-17e4e401ccb6":{"position":{"vector":[5,-332]}},"bcb77af3-fa21-49fd-8173-34c2b729218f":{"position":{"vector":[11,-591]}},"4ce11549-60dd-46e7-8d62-3c2800f12719":{"position":{"vector":[5,-404]}},"69e4cb83-90b9-4db2-ab7e-c914f49c7722":{"position":{"vector":[5,-663]}},"0409e7fc-e7f6-45c3-832b-b8f40bb8a8e0":{"position":{"vector":[-403,-735]},"visualization":{"show":false,"width":851.81640625,"height":186.8984375}},"95e5e435-ed62-4fa4-9e6c-610ebf796e46":{"position":{"vector":[-396,-656]}},"603da34e-2c94-4e04-9676-be68f03381c5":{"position":{"vector":[-396,-656]}},"74c6dc74-6764-41d1-a541-98767571a140":{"position":{"vector":[-396,-656]}},"425d49e3-847f-4e58-a496-e2b7405364f9":{"position":{"vector":[-403,-807]}},"11af906e-a55d-41c3-939a-0be843a5b94b":{"position":{"vector":[-403,-807]}},"c1a62721-cf7c-490f-af65-20345afc5ffc":{"position":{"vector":[-403,-879]},"visualization":{"show":false,"width":1106.94140625,"height":512.47265625}},"24cd607b-3202-4c4a-bd27-563e8df03571":{"position":{"vector":[-403,-920]}},"77f58d17-2010-4031-b62a-5b4a115cc99c":{"position":{"vector":[-403,-920]}},"24ddf802-0bd1-430a-b1cc-0ee2239f4d2f":{"position":{"vector":[-403,-920]}},"a6239834-c8e2-4d7b-aa2e-c7cfc64be433":{"position":{"vector":[-403,-951]}},"7b197091-4db1-40fe-9a67-86e3f3bca6bc":{"position":{"vector":[-403,-992]}},"df9c26c7-cf78-46d4-98d2-c05696039acd":{"position":{"vector":[-403,-1023]},"visualization":{"show":false,"width":470.67578125}},"32bb291b-e25a-4c89-8760-5c41b841f251":{"position":{"vector":[-403,-1064]}},"e4d79fc2-d38f-4d6c-b5a4-5ef5b916c8e4":{"position":{"vector":[-403,-1116]}},"18200431-165c-4116-9893-2f5dc79ff54d":{"position":{"vector":[-403,-1286]}},"3e1e7e92-b03c-4f00-a65e-44656bf5bcbf":{"position":{"vector":[-474,-1228]},"visualization":{"show":false,"height":183.5546875}},"3da8c33d-1103-4ebe-af90-ece19487beb6":{"position":{"vector":[-474,-1409]}},"6d2458a8-f38a-463d-8545-f66ae1d6d3bc":{"position":{"vector":[-474,-1409]}},"83fc9500-236d-4115-8773-3b4c759f89ca":{"position":{"vector":[-474,-1409]}},"137054d1-242c-4227-a58e-386506a9414e":{"position":{"vector":[-474,-1300]}},"fcb092bc-992c-435c-bc95-93ef10e93e86":{"position":{"vector":[-427,-1668]}},"f4a2ba8c-ec97-43b2-808b-c503d73bdb6a":{"position":{"vector":[-232,-1372]}},"9a1654d1-fe07-4050-b03c-07cd34eb1f02":{"position":{"vector":[-175,-1528]}},"cd2cc1f3-4e7c-4095-b680-e24b599bbf8c":{"position":{"vector":[-297,-1444]}},"c0db1295-5f57-4f19-85fd-17890d93e02c":{"position":{"vector":[-474,-1516]},"visualization":{"show":false,"height":180.19921875}},"1d25c775-6ff4-43fd-b3ee-11599e30533c":{"position":{"vector":[-437,-1989]}},"b181f8f6-ef42-4986-9191-f72fa0f64f44":{"position":{"vector":[-474,-1588]}},"7f4bd2d1-a844-4a6c-9eab-e1f22f6a224d":{"position":{"vector":[-460,-2225]}},"bb3ff5ae-a767-421c-947d-5ed5da39d001":{"position":{"vector":[86,-1009]},"visualization":{"show":false,"width":582.578125,"height":433.92578125}},"87eb12ca-b0df-43ca-8275-11f182fea115":{"position":{"vector":[168,-1009]}},"eff81253-44f8-4bd5-9340-912013fc8056":{"position":{"vector":[168,-1009]}},"0e725942-cc1f-4d2f-bd3a-cc385d2a2d3f":{"position":{"vector":[86,-1081]},"visualization":{"show":false,"height":339.28515625}},"7b96a543-6696-4ecd-bda7-11a83eece4c0":{"position":{"vector":[168,-1515]}},"fb0957ea-ad38-4322-a201-907be08cda50":{"position":{"vector":[86,-1156]}},"72ea1696-029a-4659-b460-23a05cd1fb59":{"position":{"vector":[234,-1153]}},"b792dadc-c329-4a47-9e68-072cd342bace":{"position":{"vector":[234,-1153]}},"d6536700-3a0d-4028-a140-94e9ddbb8a76":{"position":{"vector":[86,-1228]}},"5fd9c320-8a24-4ad3-8761-0f0430581ae6":{"position":{"vector":[168,-1153]}},"6254d52a-3709-4ec8-9093-021dd9ed5003":{"position":{"vector":[168,-1153]}},"7f38bd13-4b20-4c7d-b8d1-8f8a5f3f06c2":{"position":{"vector":[18,-1318]}},"51cf8779-b972-4778-9be3-c30a69239b3a":{"position":{"vector":[156,-1409]}},"402b2b68-9212-4197-9e77-977a3384b3ef":{"position":{"vector":[156,-1409]}},"6db8b87f-6a73-494c-a592-2a7ee5b04d08":{"position":{"vector":[155,-1409]}},"242ec5de-7262-4eb2-89e2-749180e2e92c":{"position":{"vector":[17,-1390]}},"511e0fd8-2977-441d-8e7b-563b6b9e29a7":{"position":{"vector":[156,-1631]}},"160702ad-156f-40d9-ac72-ca8bd014d6ea":{"position":{"vector":[22,-1516]},"visualization":{"show":false,"height":180.19921875}},"37cb3916-2ae9-4466-85db-ef7e67ff951b":{"position":{"vector":[22,-1588]}}},"widget":{},"snapshot":"eJyNVdtu2zgQffdXDJQH2YhDR7KTXgB3kTpBYWC3DZBt98ExhIk0ktmlSJWkanuxH7/QjbJzafZJgs7M8MyZw1GqVQ53FmWCOmEf0RDwvFDaAgoxSI/QP/FB/AK+RosPvyxw9dfdy+AnpTJB0VXBX465k2qbCvz76Iz21QXd7DAvBJknwDduShT8H7RcycHg5ASWiy+fIdOqLAYZ2SjnSSIoKjAjQLl/C/MBAFSv72Bef2GmENyCP/ZrhEtLGekA5jAcVmFMkMzsBs4gGMEEwlFXIKhiunBmdSljtOTQ86b+O4a2iXZIAwTnrEBtKGpLOHgwyJHLlmjKBVUJ1SSYJkzAn3w1pM0EE80F7ScLldDk6sviLDwPZ2c30qjJNe4vJlwWpWV2Z5u+Tk6gFkHphDSXGeiyEvSAU31Uy8mqyNbWGGrKaAfe8D5ho/t/m4f0nAjhq4m/vb9PTlfj9ej0PjltE+uQVoeQYZJEWm0jWeYPpMH7WiRoaZl4fWx1TJPUjKs6R6utAX+hRJlLvw+ddqFPC98qwyujeIeKGLAKCq2SMibgEgjjDZQ1hb7oRVd02vTZI7N2muy74rILZmwpJWlYDRm7+VGicEQh8B3n0bpT0XGeMU0Sc4riOsTAaniLXLNvKEoCv2vAB/8jpUpTV6NOvmyoTF+l0gnsj8bwlGH4HMNZx/DyfzO8Si3pgxIXDb0ZS7mwpGFIu0KDv2o6WX9Y1Qlrf9RNR3BjQaXAZay0pthCR9z5tm35gmGWacrQEqz69tZdpUWb34zV9JK96X1Vi1aXZOx3Sm10s4tFafhPekE715gr8qa660eObFZOHVRh50fb4Q/kkj23pI42TJ2bYwGPIrveblFb6JdL2PoxYLHKi9ISMHZX5g6f9oN8VrPxgVPXsGJsoUppXa9B5/cpM9UmrqT5jDk9MVXzsU72gbFrMjHJhMus1y1opxfMWIzGwurwZMYWG9Rdk0tIlPQtYGxLFGIPMWqC7QYt2A2BqNLbW87rC51Rg6A0W9JgFHwvja3u+W4P3MKW2w3MQkelNWfwgiqtEvWGlxV2cJ0NFajRKj33xh6YMk35bu6NZ6Hn/Ld85OADB7b2uHT+C167s71+znhvW+P1/Bw9t6i7387rZnKqhO0/LHxspv8ALDue4A=="}}