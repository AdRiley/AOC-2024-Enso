from Standard.Base import all
from Standard.Table import all
from Standard.Database import all
from Standard.AWS import all
from Standard.Google_Api import all
from Standard.Microsoft import all
from Standard.Snowflake import all
from Standard.Tableau import all
import Standard.Examples
import Standard.Visualization

main =
    file1 = Data.read '/Users/adriley/Code/AOC-2024-Enso/Day25/input.txt' ..Delimited
    vector1 = [Nothing]
    any2 = vector1.to_table ["Tumbler"]
    table3 = any2.union file1 match_columns=..By_Position
    table1 = table3.add_row_number "ID"
    any1 = table1.set (expr 'if is_nothing([Tumbler]) then [ID] else Nothing') "ID"
    table2 = any1.fill_nothing ['ID'] Previous_Value
    table4 = table2.filter_blank_rows
    any3 = table4.aggregate ['ID'] [..First 'Tumbler']
    table5 = table4.parse_to_columns 'Tumbler' "(.)(.)(.)(.)(.)"
    any4 = table5.transpose ['ID']
    any5 = any4.aggregate ['ID', 'Name', 'Value'] [..Count]
    ## Locks
    any6 = any3.filter 'First Tumbler' (..Equal "#####")
    ## Keys
    any7 = any3.filter 'First Tumbler' (..Equal ".....")
    table6 = any5.join any6 ..Inner
    any8 = table6.filter 'Value' (..Equal "#")
    table7 = any5.join any7 ..Inner
    any9 = table7.filter 'Value' (..Equal ".")
    table8 = any8.join any9 join_kind=..Inner on=[(..Equals 'Name' 'Name')]
    any10 = table8.filter 'Count' (..Equal_Or_Less (..Name 'Right Count'))
    any11 = any10.aggregate ['ID', 'Right ID'] [..Count]
    any13 = any11.filter 'Count' (..Equal 5)
    integer1 = any13.row_count



#### METADATA ####
[[{"index":{"value":338},"size":{"value":61}},"0bb1791e-bfda-456d-8408-4538c72e0af1"],[{"index":{"value":338},"size":{"value":73}},"fcf199e6-d2b1-44b7-be92-a47545d6a593"],[{"index":{"value":426},"size":{"value":9}},"c0554c1b-9d58-42a3-9fe1-1040c29e9304"],[{"index":{"value":447},"size":{"value":16}},"665c793b-48b4-41a6-87d0-c6d60358da6c"],[{"index":{"value":447},"size":{"value":28}},"5af4545a-8541-49ce-a14e-aa855a069564"],[{"index":{"value":489},"size":{"value":10}},"37da634d-63a9-46c7-a2bf-06adfa35d010"],[{"index":{"value":489},"size":{"value":16}},"fb75ad69-ad3d-4246-8d3e-f49cc73b8195"],[{"index":{"value":489},"size":{"value":44}},"14545b1f-0f0b-437b-87b1-3e8edec68906"],[{"index":{"value":547},"size":{"value":21}},"597545c6-9dcf-4538-8c67-a1d662665f81"],[{"index":{"value":547},"size":{"value":26}},"93ce745e-6896-430c-b8a5-e0def946fadb"],[{"index":{"value":585},"size":{"value":10}},"ab7e2eeb-e10d-4262-85b7-af75f59aaeb6"],[{"index":{"value":585},"size":{"value":67}},"c6b5e081-7552-4248-91f0-014d0e84bbfd"],[{"index":{"value":585},"size":{"value":72}},"505bd07f-fdd6-421e-8d52-71c15fd875aa"],[{"index":{"value":671},"size":{"value":17}},"3ae55923-a6b6-4544-93bd-31f60f5b6120"],[{"index":{"value":671},"size":{"value":24}},"7f144e21-b9e4-4d10-abfe-36bba525b2b8"],[{"index":{"value":671},"size":{"value":39}},"4e3bff51-3760-4c03-b787-4e623dadb922"],[{"index":{"value":724},"size":{"value":24}},"8ae8ab6e-903a-41f8-a453-33eb01e43d06"],[{"index":{"value":760},"size":{"value":16}},"45078297-6ac2-4c14-a64b-c9b9c08e12d4"],[{"index":{"value":760},"size":{"value":23}},"d4d2efb9-e780-4209-ba66-333d5780a75b"],[{"index":{"value":760},"size":{"value":43}},"9c3957f4-3154-4e24-bac8-73d4d47d7166"],[{"index":{"value":817},"size":{"value":23}},"ffe9ae81-14f2-45d3-aa9a-f2c36bf8a689"],[{"index":{"value":817},"size":{"value":33}},"fdc9b3e9-378f-40c2-b34f-7d09839b2559"],[{"index":{"value":817},"size":{"value":51}},"62d22da4-1ccd-4ae1-b6f0-a0ac11beacbf"],[{"index":{"value":880},"size":{"value":16}},"3df49173-aae9-4ca5-9d1d-080a253b2ec5"],[{"index":{"value":880},"size":{"value":23}},"cdd1d623-b316-41ef-ad9c-4a2d231c851c"],[{"index":{"value":915},"size":{"value":14}},"3edc6665-9274-48db-bc5d-9fc6d108eea9"],[{"index":{"value":915},"size":{"value":38}},"86d37f97-2931-4193-b975-e1099d6f4730"],[{"index":{"value":915},"size":{"value":48}},"5607145e-03ec-420f-85c7-08b45339160c"],[{"index":{"value":988},"size":{"value":11}},"c62cc299-d9fa-4d9c-8508-38afb3b11af6"],[{"index":{"value":988},"size":{"value":27}},"13226a45-137e-4a4c-bd4e-10005dd31d54"],[{"index":{"value":988},"size":{"value":45}},"f5123e88-b41c-4e28-8cbf-821e56485ee2"],[{"index":{"value":1057},"size":{"value":11}},"2c031ce5-4c77-4333-98a9-38a4c7cc25b1"],[{"index":{"value":1057},"size":{"value":27}},"8cba2cf5-f29b-4150-b401-3fc09f79df70"],[{"index":{"value":1057},"size":{"value":45}},"98fe778d-2046-4eaa-ae4f-4066e0d336df"],[{"index":{"value":1116},"size":{"value":9}},"c905b10a-d077-41eb-8bc5-a5cfbdd42fb9"],[{"index":{"value":1116},"size":{"value":14}},"6008e4c4-082d-4bbe-8f26-51c73c4e3ddf"],[{"index":{"value":1116},"size":{"value":22}},"ccc4d1ef-a7e3-48d6-b589-b886a4d9772b"],[{"index":{"value":1150},"size":{"value":13}},"eef0563e-c1e9-4f67-a254-74d9024a0e47"],[{"index":{"value":1150},"size":{"value":21}},"50966291-d0d9-4c05-87f6-4346de860ad4"],[{"index":{"value":1150},"size":{"value":35}},"02ef869a-0bcc-42e8-b804-8062344967eb"],[{"index":{"value":1199},"size":{"value":14}},"24f2f949-1ddd-4ea4-b2ce-c330f378144a"],[{"index":{"value":1199},"size":{"value":22}},"803dc67e-1af8-41d9-a79f-a218957ee972"],[{"index":{"value":1233},"size":{"value":35}},"e35a599f-7c57-4816-a994-94512cbb515c"],[{"index":{"value":1282},"size":{"value":9}},"14fe1f99-9e39-49f5-97c0-6dd5c9b46798"],[{"index":{"value":1282},"size":{"value":14}},"17010a1b-669c-48f4-a8a5-e7d5c48cf435"],[{"index":{"value":1282},"size":{"value":32}},"31861f8b-8115-4a71-93db-0657b51c0030"],[{"index":{"value":1282},"size":{"value":62}},"4f1307f9-5477-44c5-9079-e95d2098b2e5"],[{"index":{"value":1357},"size":{"value":13}},"9c2b9646-0434-408b-a656-7ae2035a3c8a"],[{"index":{"value":1357},"size":{"value":21}},"f6646535-ff77-4a0e-a124-a50b34e8f66f"],[{"index":{"value":1357},"size":{"value":62}},"22a9cb41-79f1-4358-a758-e245f07253a6"],[{"index":{"value":1432},"size":{"value":15}},"b08200a4-d511-42c7-883f-18ebfb92075e"],[{"index":{"value":1432},"size":{"value":34}},"cece7177-03ae-4609-83c3-fe450a2381a6"],[{"index":{"value":1432},"size":{"value":44}},"33845d23-2eb8-4306-8e19-469d17f0f5f7"],[{"index":{"value":1489},"size":{"value":12}},"a91791b0-21f7-4773-80b1-43e7c3d49068"],[{"index":{"value":1489},"size":{"value":20}},"fdb0bbfb-d56d-4808-a0ae-fc3e9c5cc5b5"],[{"index":{"value":1489},"size":{"value":32}},"e484ab67-030f-4b3b-9851-f2f80086287e"],[{"index":{"value":1537},"size":{"value":15}},"d7f6b2ff-2528-4395-881b-f218683280d0"]]
{"ide":{"node":{"fcf199e6-d2b1-44b7-be92-a47545d6a593":{"position":{"vector":[-479,607]},"visualization":{"show":false,"width":1129.671875,"height":399.22265625}},"0bb1791e-bfda-456d-8408-4538c72e0af1":{"position":{"vector":[-479,607]},"visualization":{"show":true,"width":1129.671875,"height":399.22265625}},"c0554c1b-9d58-42a3-9fe1-1040c29e9304":{"position":{"vector":[-479,535]}},"5af4545a-8541-49ce-a14e-aa855a069564":{"position":{"vector":[-479,463]}},"665c793b-48b4-41a6-87d0-c6d60358da6c":{"position":{"vector":[-479,463]}},"14545b1f-0f0b-437b-87b1-3e8edec68906":{"position":{"vector":[-479,391]}},"fb75ad69-ad3d-4246-8d3e-f49cc73b8195":{"position":{"vector":[-479,391]}},"37da634d-63a9-46c7-a2bf-06adfa35d010":{"position":{"vector":[-626,463]}},"93ce745e-6896-430c-b8a5-e0def946fadb":{"position":{"vector":[-479,295]}},"597545c6-9dcf-4538-8c67-a1d662665f81":{"position":{"vector":[-479,535]}},"505bd07f-fdd6-421e-8d52-71c15fd875aa":{"position":{"vector":[-479,223]},"visualization":{"show":false,"height":474.83203125}},"c6b5e081-7552-4248-91f0-014d0e84bbfd":{"position":{"vector":[-479,463]}},"ab7e2eeb-e10d-4262-85b7-af75f59aaeb6":{"position":{"vector":[-479,463]}},"4e3bff51-3760-4c03-b787-4e623dadb922":{"position":{"vector":[-479,151]},"visualization":{"show":false,"height":407.1484375}},"7f144e21-b9e4-4d10-abfe-36bba525b2b8":{"position":{"vector":[-479,391]}},"3ae55923-a6b6-4544-93bd-31f60f5b6120":{"position":{"vector":[-479,391]}},"8ae8ab6e-903a-41f8-a453-33eb01e43d06":{"position":{"vector":[-479,79]},"visualization":{"show":false,"height":327.5078125}},"9c3957f4-3154-4e24-bac8-73d4d47d7166":{"position":{"vector":[122,-65]},"visualization":{"show":false,"height":397.31640625}},"d4d2efb9-e780-4209-ba66-333d5780a75b":{"position":{"vector":[-479,7]}},"45078297-6ac2-4c14-a64b-c9b9c08e12d4":{"position":{"vector":[-479,7]}},"62d22da4-1ccd-4ae1-b6f0-a0ac11beacbf":{"position":{"vector":[-479,7]},"visualization":{"show":false,"width":953.77734375,"height":397.89453125}},"fdc9b3e9-378f-40c2-b34f-7d09839b2559":{"position":{"vector":[-479,7]}},"ffe9ae81-14f2-45d3-aa9a-f2c36bf8a689":{"position":{"vector":[-479,7]}},"cdd1d623-b316-41ef-ad9c-4a2d231c851c":{"position":{"vector":[-479,-65]},"visualization":{"show":false,"height":236.640625}},"3df49173-aae9-4ca5-9d1d-080a253b2ec5":{"position":{"vector":[-479,-65]}},"5607145e-03ec-420f-85c7-08b45339160c":{"position":{"vector":[-479,-137]},"visualization":{"show":false,"height":236.81640625}},"86d37f97-2931-4193-b975-e1099d6f4730":{"position":{"vector":[-479,-137]}},"3edc6665-9274-48db-bc5d-9fc6d108eea9":{"position":{"vector":[-479,-137]}},"f5123e88-b41c-4e28-8cbf-821e56485ee2":{"position":{"vector":[122,-155]}},"13226a45-137e-4a4c-bd4e-10005dd31d54":{"position":{"vector":[122,-137]}},"c62cc299-d9fa-4d9c-8508-38afb3b11af6":{"position":{"vector":[122,-137]}},"98fe778d-2046-4eaa-ae4f-4066e0d336df":{"position":{"vector":[328,-252]}},"8cba2cf5-f29b-4150-b401-3fc09f79df70":{"position":{"vector":[328,-252]}},"2c031ce5-4c77-4333-98a9-38a4c7cc25b1":{"position":{"vector":[328,-252]}},"ccc4d1ef-a7e3-48d6-b589-b886a4d9772b":{"position":{"vector":[-479,-252]},"visualization":{"show":false,"width":560.81640625,"height":228.97265625}},"6008e4c4-082d-4bbe-8f26-51c73c4e3ddf":{"position":{"vector":[-479,-252]},"visualization":{"show":false,"width":560.81640625,"height":228.97265625}},"c905b10a-d077-41eb-8bc5-a5cfbdd42fb9":{"position":{"vector":[-479,-209]}},"02ef869a-0bcc-42e8-b804-8062344967eb":{"position":{"vector":[-479,-324]},"visualization":{"show":false,"width":651.3203125,"height":332.73046875}},"50966291-d0d9-4c05-87f6-4346de860ad4":{"position":{"vector":[-479,-324]}},"eef0563e-c1e9-4f67-a254-74d9024a0e47":{"position":{"vector":[-479,-324]}},"803dc67e-1af8-41d9-a79f-a218957ee972":{"position":{"vector":[-65,-252]},"visualization":{"show":false,"width":560.81640625,"height":228.97265625}},"24f2f949-1ddd-4ea4-b2ce-c330f378144a":{"position":{"vector":[-65,-252]},"visualization":{"show":false,"width":560.81640625,"height":228.97265625}},"e35a599f-7c57-4816-a994-94512cbb515c":{"position":{"vector":[-65,-378]}},"4f1307f9-5477-44c5-9079-e95d2098b2e5":{"position":{"vector":[-479,-458]},"visualization":{"show":false,"width":832.37109375,"height":228.296875}},"31861f8b-8115-4a71-93db-0657b51c0030":{"position":{"vector":[-479,-478]}},"17010a1b-669c-48f4-a8a5-e7d5c48cf435":{"position":{"vector":[-479,-396]}},"14fe1f99-9e39-49f5-97c0-6dd5c9b46798":{"position":{"vector":[-479,-396]}},"22a9cb41-79f1-4358-a758-e245f07253a6":{"position":{"vector":[-479,-565]}},"f6646535-ff77-4a0e-a124-a50b34e8f66f":{"position":{"vector":[-479,-565]}},"9c2b9646-0434-408b-a656-7ae2035a3c8a":{"position":{"vector":[-479,-565]}},"33845d23-2eb8-4306-8e19-469d17f0f5f7":{"position":{"vector":[-479,-686]},"visualization":{"show":false,"width":611.71875,"height":232.41796875}},"cece7177-03ae-4609-83c3-fe450a2381a6":{"position":{"vector":[-479,-659]}},"b08200a4-d511-42c7-883f-18ebfb92075e":{"position":{"vector":[-479,-659]}},"e484ab67-030f-4b3b-9851-f2f80086287e":{"position":{"vector":[-479,-758]},"visualization":{"show":false,"width":643.41796875,"height":216.80078125}},"fdb0bbfb-d56d-4808-a0ae-fc3e9c5cc5b5":{"position":{"vector":[-479,-758]}},"a91791b0-21f7-4773-80b1-43e7c3d49068":{"position":{"vector":[-479,-758]}},"d7f6b2ff-2528-4395-881b-f218683280d0":{"position":{"vector":[-479,-830]},"visualization":{"show":true}}},"widget":{},"import":{},"snapshot":"eJyNk99P2zAQx9/7V5zKQxppuKSltDzkASibqvFLg7GHqIrc5pJ6dezMdoDur58Sx2mBlS2KlMj3vc9972ynSuZwb6hIqErIOdUILC+kMkA576Svog90wT8IT6mhiw8BZz/u9we/SJlxjM8Ktl9zzZZKapma/ZJ7IZ9TTtf/6oOWu4Lmt5VcvtC84KjfBR6ZLilnv6lhUnQ6OWUCwg4AQMo4BhBCNQaikCbg9b9rVLpPE8U4bvoXMsH+2e3F4eBocHx4KbTsT+lmMOozUZSGmBfjASFT5CxnBpOa+oRLI1XFjW6kWTGRzet1KjYDCF2YGBmbenei7kOZLziqrtXVq0MI6wRSCiZF4zSnZrmKl5KXudAhIeeb+E5qVvfVZlaFLYLQJImVfI5FmS9QQXc27TonrSogGg308KVQ4LEUmI6Fdd2LGl9zH8wKBUSz6RyQa4SmL8/fMmvYwLoOSMo4dxyIvNnUm8OdwicmSx0/Ul7iNunYWRlUaQZVvOBUrCvn2tkdOs0xoVmmMKMGHTci5DNT2oDX+PV25jjaJhZUaYyNdAPc6qHbI/7u246p9TYiRlGhC6ldXScZ2Z7fGfsE3g3NsfrWDVunF7IUxuYeHMCVXK7bHk8saNhMATzbVWuyR8jlr5Jy6B5UT9d3lK+4aSHj/4aQ6mkgdYtN/RH5KZmwhgiZCYHKwSduGict3ra2620XOX6LHL9FnjrkeD/ylcuJRU5a5ClUf/GaiSRs4CBFGLl83exD8/HbjQuOXO1JW7venm3t+FbFV6h1tVBlg/eNZSsDVub7LSpoDv7RX06BTXFHdecAVAnNPQ+CfRZgZKswYTBD5QoNSXWxl5W28wcKvOkb"}}